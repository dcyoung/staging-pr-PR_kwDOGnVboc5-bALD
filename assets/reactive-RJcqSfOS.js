var J=Object.defineProperty;var K=(s,e,n)=>e in s?J(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var v=(s,e,n)=>K(s,typeof e!="symbol"?e+"":e,n);import{r as t,V as R,j as a,c as $,d as X,h as O,g as ee,m as Q,M as te,Q as se,b as Y,n as ne,o as C,E as oe,T as _,i as re,k as ae}from"./index-Bc3O-PEo.js";import{a as ie,D as ce,M as le,w as ue,V as me,E as he,B as xe,N as pe}from"./Noise-DJSeMBwT.js";const fe=t.forwardRef(function({blendFunction:e,worldFocusDistance:n,worldFocusRange:u,focusDistance:c,focusRange:m,focalLength:o,bokehScale:g,resolutionScale:h,resolutionX:d,resolutionY:M,width:A,height:x,target:w,depthTexture:r,...D},I){const{camera:H}=t.useContext(ie),V=w!=null,b=t.useMemo(()=>{const P=new ce(H,{blendFunction:e,worldFocusDistance:n,worldFocusRange:u,focusDistance:c,focusRange:m,focalLength:o,bokehScale:g,resolutionScale:h,resolutionX:d,resolutionY:M,width:A,height:x});V&&(P.target=new R),r&&P.setDepthTexture(r.texture,r.packing);const L=P.maskPass;return L.maskFunction=le.MULTIPLY_RGB_SET_ALPHA,P},[H,e,n,u,c,m,o,g,h,d,M,A,x,V,r]);return t.useEffect(()=>()=>{b.dispose()},[b]),a.jsx("primitive",{...D,ref:I,object:b,target:w})}),ge=ue(me),de=s=>(s%_+_)%_;class Z extends ne{constructor(n,u,c,m=0){super();v(this,"helixLength");v(this,"helixRadius");v(this,"helixWindingSeparation");v(this,"helixStartingAngleRad");this.helixLength=n,this.helixRadius=u,this.helixWindingSeparation=c,this.helixStartingAngleRad=de(m)}getPoint(n,u=new R){n-=.5;const m=1/(this.helixLength/this.helixWindingSeparation),o=_*(n%m/m),g=this.helixRadius*Math.cos(o+this.helixStartingAngleRad),h=this.helixRadius*Math.sin(o+this.helixStartingAngleRad),d=this.helixLength*n;return u.set(g,h,d)}}const Me=(s,e)=>Math.hypot(s*Math.sin(e),s*Math.cos(e)-s),N=t.forwardRef(({coordinateMapper:s,helixLength:e=10,helixWindingSeparation:n=10,helixRadius:u=1,strandRadius:c=.1,baseSpacing:m=.35,strandOffsetRad:o=Math.PI/2,mirrorEffects:g=!0,fixedBaseGap:h=!0,...d},M)=>{const A=$(),x=X.getPalette(A).buildLut(),w=Math.floor(e/m),r=t.useRef(null),D=t.useMemo(()=>new O({color:"#606060"}),[]),I=t.useMemo(()=>{const i=.45*Me(u,o),f=new ee(c,c,i,1);for(let p=0;p<f.attributes.position.count;p++)f.attributes.position.setZ(p,f.attributes.position.getZ(p)-i/2);return f.attributes.position.needsUpdate=!0,f},[u,c,o]),H=t.useRef(null),V=t.useRef(null),b=t.useMemo(()=>new O({color:x.getColor(.5)}),[x]),[P,L,U,q]=t.useMemo(()=>{const S=new Z(e,u,n,0),i=new Z(e,u,n,o);return[S,new Q(S,100,c,12,!1),i,new Q(i,100,c,12,!1)]},[e,u,n,c,o]),l=t.useMemo(()=>new te,[]),B=t.useMemo(()=>new R,[]),E=t.useMemo(()=>new R,[]),y=t.useMemo(()=>new R,[]),k=t.useMemo(()=>new se,[]),z=t.useMemo(()=>new R(0,0,1),[]);return t.useEffect(()=>{let S=0;for(let i=0;i<w;i++){S=i/Math.max(w-1,1);const f=Math.floor(3.99*C.seededRandom(i)),p=3-f;P.getPoint(S,B),U.getPoint(S,E),l.setPosition(B),l.lookAt(B,E,z),r.current.setMatrixAt(i*2,l),r.current.setColorAt(i*2,x.getColor(f/3)),l.setPosition(E),l.lookAt(E,B,z),r.current.setMatrixAt(i*2+1,l),r.current.setColorAt(i*2+1,x.getColor(p/3))}r.current.instanceMatrix.needsUpdate=!0,r.current.instanceColor.needsUpdate=!0},[P,U,r,w,x,l,B,E,z]),Y(({clock:S})=>{const i=S.getElapsedTime();let f=0,p=0,F=0,W=0;const T=.25,G=1;for(let j=0;j<w;j++)f=j/Math.max(w-1,1),p=s.map(re.CARTESIAN_1D,g?2*Math.abs(f-.5):f,0,0,i)/s.amplitude,p=(1+p)/2,F=T+(h?2*p:p)*(G-T),W=h?T+2*(1-p)*(G-T):F,r.current.getMatrixAt(j*2,l),l.decompose(B,k,y),y.z=F,l.compose(B,k,y),r.current.setMatrixAt(j*2,l),r.current.getMatrixAt(j*2+1,l),l.decompose(E,k,y),y.z=W,l.compose(E,k,y),r.current.setMatrixAt(j*2+1,l);r.current.instanceMatrix.needsUpdate=!0}),a.jsxs("group",{...d,ref:M,children:[a.jsx("mesh",{ref:H,geometry:L,material:b,castShadow:!0,receiveShadow:!0}),a.jsx("mesh",{ref:V,geometry:q,material:b,castShadow:!0,receiveShadow:!0}),a.jsx("instancedMesh",{ref:r,args:[I,D,2*w],castShadow:!0,receiveShadow:!0})]})});N.displayName="BaseDoubleHelix";const Ae=s=>{const e=[t.useRef(null),t.useRef(null),t.useRef(null),t.useRef(null),t.useRef(null)],n=e.length,u=15,c=Array.from({length:n}).map((m,o)=>new R().fromArray(Array.from({length:3}).map((g,h)=>2*C.seededRandom(o+h)-1)).normalize().multiplyScalar(u));return Y(({clock:m})=>{const o=m.getElapsedTime(),g=5e-4,h=.05;let d,M=0;e.forEach((A,x)=>{A.current&&(d=c[x],M=Math.sin(h*(.5+.5*C.seededRandom(x))*o+C.seededRandom(x)/h),A.current.position.set(d.x*M,d.y*M,d.z*M),A.current.rotation.z+=g*Math.cos((.5+.5*C.seededRandom(x))*o),A.current.rotation.y+=g*Math.cos((.5+.5*C.seededRandom(x))*o))})}),a.jsx(a.Fragment,{children:e.map((m,o)=>a.jsx(N,{ref:m,position:c[o],rotation:new oe(...Array.from({length:3}).map((g,h)=>Math.PI*(2*C.seededRandom(o+h)-1))),...s},o))})},{useParams:we,useActions:je}=ae({default:{multi:!0,helixLength:50,helixRadius:1,helixWindingSeparation:10,strandRadius:.1,baseSpacing:.35,strandOffsetRad:Math.PI/2,mirrorEffects:!0,fixedBaseGap:!1}}),Se=({coordinateMapper:s})=>{const{multi:e,...n}=we();return e?a.jsx(Ae,{coordinateMapper:s,...n}):a.jsx(N,{coordinateMapper:s,...n})},Ce=s=>a.jsxs(a.Fragment,{children:[a.jsx(Se,{...s}),a.jsxs(he,{children:[a.jsx(fe,{focusDistance:0,focalLength:.02,bokehScale:3,height:480}),a.jsx(xe,{luminanceThreshold:0,luminanceSmoothing:.9,height:300}),a.jsx(pe,{opacity:.02}),a.jsx(ge,{eskil:!1,offset:.1,darkness:1.1})]})]});export{Ce as default,je as useActions,we as useParams};
